<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="static/echarts.js"></script>

</head>
<body>
    <div id="main" style="width: 800px;height:600px;"></div>
    <script type="text/javascript">
        var date = [];
        var data = [];
        var myChart = echarts.init(document.getElementById('main'));

        function getNowFormatDate() {
            var date = new Date();
            var seperator1 = "-";
            var seperator2 = ":";
            var month = date.getMonth() + 1;
            var strDate = date.getDate();
            if (month >= 1 && month <= 9) {
                month = "0" + month;
            }
            if (strDate >= 0 && strDate <= 9) {
                strDate = "0" + strDate;
            }
            var currentdate = month + seperator1 + strDate
                    + " " + date.getHours() + seperator2 + date.getMinutes()
                    + seperator2 + date.getSeconds();
            return currentdate;
        }

        data.push(0)
        date.push(getNowFormatDate())
        //更新当前数据集
        function addData(shift) {
            now = getNowFormatDate();
            date.push(now);
            data.push((data.length>0)?((Math.random() - 0.4) * 10 + data[data.length - 1]):0);

            if (shift & date.length>120) {
                date.shift();
                data.shift();
            }   
        }

        option = {
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: date
            },
            yAxis: {
                boundaryGap: [0, '50%'],
                type: 'value'
            },
            series: [
                {
                    name:'成交',
                    type:'line',
                    smooth:true,
                    symbol: 'none',
                    stack: 'a',
                    // areaStyle: {
                    //     normal: {}
                    // },
                    data: data
                }
            ]
        };
        myChart.setOption(option);
        

        setInterval(function () {
            addData(true);
            myChart.setOption({
                xAxis: {
                    data: date
                },
                series: [{
                    name:'成交',
                    data: data
                }]
            });
        }, 1000);
    </script>
</body>
</html>